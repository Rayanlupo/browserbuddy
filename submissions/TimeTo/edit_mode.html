<!DOCTYPE html>
<html lang="en">
<head>
    <title>Edit Mode</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container mt-3" style="width: 450px;">
    <button id="back-button">Back</button>

    <div class="modeTitleContainer">
        <input type="text" class="modeTitle" id="modeNameInput" placeholder="Mode Name" autofocus readonly>
    </div>

    <div id="URL-list">
        <!-- URL inputs will be loaded here -->
    </div>
    <button id="addInput">+ Add website</button>
    <button id="save-button">Save</button>
    <button id="delete-button">Delete Mode</button>
</div>

<script>
    const urlContainer = document.getElementById("URL-list");
    const urlParams = new URLSearchParams(window.location.search);
    const modeName = urlParams.get("mode");
    let storageKey = `savedURL_${modeName}`;
    const savedURLs = JSON.parse(localStorage.getItem(storageKey)) || [];
    document.getElementById("modeNameInput").value = modeName;

    const loadURLs = () => {
        savedURLs.forEach((url) => {
            const inputContainer = document.createElement("div");
            inputContainer.className = "URL";
            const input = document.createElement("input");
            input.type = "url";
            input.className = "urlInput";
            input.value = url;
            inputContainer.appendChild(input);
            urlContainer.appendChild(inputContainer);
        });
    };

    const addInputField = () => {
        const inputContainer = document.createElement("div");
        inputContainer.className = "URL";
        const input = document.createElement("input");
        input.type = "url";
        input.className = "urlInput";
        input.placeholder = "URL";
        inputContainer.appendChild(input);
        urlContainer.appendChild(inputContainer);
        input.focus();
    };

    const saveMode = () => {
        const inputs = document.querySelectorAll(".urlInput");
        const urls = Array.from(inputs).map(input => input.value.trim()).filter(url => url !== "");
        localStorage.setItem(storageKey, JSON.stringify(urls));
        alert(`Mode "${modeName}" updated successfully!`);
    };

    const deleteMode = () => {
        if (confirm(`Are you sure you want to delete the mode "${modeName}"?`)) {
            localStorage.removeItem(storageKey);
            alert(`Mode "${modeName}" deleted successfully!`);
            window.location.href = "index.html"; // Navigate back to the main page
        }
    };

    document.getElementById("back-button").addEventListener("click", () => {
        window.history.back();
    });

    document.getElementById("addInput").addEventListener("click", addInputField);

    document.getElementById("save-button").addEventListener("click", saveMode);

    document.getElementById("delete-button").addEventListener("click", deleteMode);

    // Load URLs when the page loads
    loadURLs();
</script>

</body>
</html>
