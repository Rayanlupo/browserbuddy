<!DOCTYPE html>
<html>
<head>
    <title>It's time to...</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Lexend:wght@100..900&family=Nunito+Sans:ital,opsz,wght@0,6..12,200..1000;1,6..12,200..1000&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-3" style="width: 450px;">
        <h1>It's time to...</h1>
        <div class="modes-flex" id="modes-container">
            <!-- Modes will be loaded here -->
        </div>
        <button id="addMode">Add Mode</button>
    </div>

    <script>
        document.getElementById("addMode").addEventListener("click", () => {
            window.location.href = "add_url.html";
        });

        const openLinksForMode = (modeName) => { window.location.href = `list_links.html?mode=${modeName}`; };

        const editMode = (modeName) => {
            const storageKey = `savedURL_${modeName}`;
            let savedURLs = JSON.parse(localStorage.getItem(storageKey)) || [];
            let newURLs = prompt(`Edit URLs for ${modeName} (separate multiple URLs with commas):`, savedURLs.join(","));
            if (newURLs !== null) {
                savedURLs = newURLs.split(",").map(url => url.trim());
                localStorage.setItem(storageKey, JSON.stringify(savedURLs));
                alert(`URLs for ${modeName} updated successfully!`);
            }
        };

        const loadModes = () => {
            const modesContainer = document.getElementById("modes-container");
            modesContainer.innerHTML = '';
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('savedURL_')) {
                    const modeName = key.replace('savedURL_', '');
                    const modeDiv = document.createElement('div');
                    modeDiv.className = 'mode';
                    modeDiv.innerHTML = `
                        <a class="play-button-a" href="#">
                            <img class="play-button" src="icons/play.svg" alt="play-button">
                        </a>
                        <h2 class="mode-name nunito">${modeName}</h2>
                        <img src="icons/edit.svg" alt="edit icon" class="edit_icon" data-mode-name="${modeName}">
                    `;
                    modesContainer.appendChild(modeDiv);
                }
            }

            // Reattach click event listeners for dynamically created play buttons
            const playButtons = document.querySelectorAll(".play-button-a");
            playButtons.forEach((button) => {
                button.addEventListener("click", (event) => {
                    event.preventDefault(); // Prevent default action
                    const modeName = button.nextElementSibling.textContent.trim();
                    console.log(`Clicked mode: ${modeName}`); // Debug statement
                    openLinksForMode(modeName);
                });
            });


            const editButtons = document.querySelectorAll(".edit_icon");
            editButtons.forEach((button) => {
                button.addEventListener("click", (event) => {
                    const modeName = button.dataset.modeName.trim();
                    console.log(`Editing mode: ${modeName}`); // Debug statement
                    window.location.href = `edit_mode.html?mode=${modeName}`;
                });
            });
        };

     
        window.onload = loadModes;
    </script>
</body>
</html>
